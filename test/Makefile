#
#--Makefile to remake the executable and copy to this directory
#  Generated by /home/josh/phantom/scripts/writemake.sh: Wed Jul 29 19:27:42 AEST 2020
#
PHANTOMDIR=/home/josh/phantom/
SPLASHDIR=/home/josh/splash
EDITOR=vi
ifndef SETUP
SETUP=disc
endif

again:
	cd ${PHANTOMDIR}; make SETUP=${SETUP} RUNDIR=${PWD}; cd -; cp ${PHANTOMDIR}/bin/phantom .; cp ${PHANTOMDIR}/bin/phantom_version .

all: again setup infile

.PHONY: phantom phantomsetup phantom2power phantom2grid phantomanalysis phantomevcompare libphantom mflow
phantom         : again
phantomsetup    : setup
phantom2power   : power
phantom2grid    : grid
phantomanalysis : analysis
phantomevcompare: evcompare
libphantom      : phantomlib
mflow           : mflow

clean:
	cd ${PHANTOMDIR}; make clean
setup:
	cd ${PHANTOMDIR}; make SETUP=${SETUP} RUNDIR=${PWD} setup; cd -; cp ${PHANTOMDIR}/bin/phantomsetup .
moddump:
	cd ${PHANTOMDIR}; make SETUP=${SETUP} RUNDIR=${PWD} moddump; cd -; cp ${PHANTOMDIR}/bin/phantommoddump .
analysis:
	cd ${PHANTOMDIR}; make SETUP=${SETUP} RUNDIR=${PWD} phantomanalysis; cd -; cp ${PHANTOMDIR}/bin/phantomanalysis .
phantomlib:
	cd ${PHANTOMDIR}; make SETUP=${SETUP} RUNDIR=${PWD} libphantom; cd -; cp ${PHANTOMDIR}/bin/libphantom.so .
pyanalysis:
	cd ${PHANTOMDIR}; make SETUP=${SETUP} RUNDIR=${PWD} pyanalysis; cd -; cp ${PHANTOMDIR}/bin/libphantom.so .; ${PHANTOMDIR}/scripts/pyphantom/writepyanalysis.sh 
power:
	cd ${PHANTOMDIR}; make SETUP=${SETUP} RUNDIR=${PWD} phantom2power; cd -; cp ${PHANTOMDIR}/bin/phantom2power .
grid:
	cd ${PHANTOMDIR}; make SETUP=${SETUP} RUNDIR=${PWD} phantom2grid; cd -; cp ${PHANTOMDIR}/bin/phantom2grid .
evcompare:
	cd ${PHANTOMDIR}; make SETUP=${SETUP} RUNDIR=${PWD} phantomevcompare; cd -; cp ${PHANTOMDIR}/bin/phantomevcompare .
mflow:
	cd ${PHANTOMDIR}; make SETUP=${SETUP} RUNDIR=${PWD} mflow; cd -; cp ${PHANTOMDIR}/bin/mflow .; cp ${PHANTOMDIR}/bin/ev2mdot .; cp ${PHANTOMDIR}/bin/lombperiod .
make:
	cd ${PHANTOMDIR}; ${EDITOR} build/Makefile &
qscript:
	@cd ${PHANTOMDIR}; make --quiet SETUP=${SETUP} RUNDIR=${PWD} qscript
%::
	cd ${PHANTOMDIR}; make SETUP=${SETUP} RUNDIR=${PWD} ${MAKECMDGOALS}; if [ -e ${PHANTOMDIR}/bin/$@ ]; then cd -; cp ${PHANTOMDIR}/bin/$@ .; fi
#
# the following are for rebuilding splash
#
plot:
	cd ${SPLASH_DIR}; make sphNG
plotc:
	cd ${SPLASH_DIR}; make clean
